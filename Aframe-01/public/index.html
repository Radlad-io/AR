<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Image based tracking AR.js demo</title>
  <!-- Styles -->
  <link rel="stylesheet" href="./css/style.css" />

  <!-- import aframe and then ar.js with image tracking / location based features -->
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

</head>

<body style="margin: 0px; overflow: hidden">

  <div class="arjs-loader">
    <img id="loading_image" src="https://kevinmerinsky.nyc3.digitaloceanspaces.com/ar-test/ar-test/images/Temple_Mark.png" />
    <div class="classic-4"></div>
  </div>

  
  <a-scene 
  vr-mode-ui="enabled: false;" 
  renderer=" antialias: false; logarithmicDepthBuffer: true;"
  stats
  embedded arjs="
        trackingMethod: best; 
        sourceType: webcam;
        sourceWidth:1280; 
        sourceHeight:960; 
        displayWidth: 1280; 
        displayHeight: 960;
        debugUIEnabled: false;">

        <a-assets>
          <img id="video_tn" src="./images/play_button.png">
          <video 
            id="video_01" 
            src="./video/video_01.mp4"
            loop="true"
          >
          </video>
        </a-assets>

    <a-nft type="nft" emitevents="true"
      url="https://arjs-cors-proxy.herokuapp.com/https://kevinmerinsky.nyc3.digitaloceanspaces.com/ar-test/ar-test/marker_300_square_01/marker_300_square_01"
      smooth="true" smoothCount="5" smoothTolerance=".1" smoothThreshold="5">
      <a-entity
        geometry="primitive: box" 
        material="color: red"
        scale="700 0 400"
        position="225 0 -200"
        >
    </a-nft>

<!-- TODO: Test smoothing paramaters: https://ar-js-org.github.io/AR.js-Docs/image-tracking/ -->
    <a-nft 
      type="nft" 
      emitevents="true"
      url="https://arjs-cors-proxy.herokuapp.com/https://kevinmerinsky.nyc3.digitaloceanspaces.com/ar-test/ar-test/maker_300_square_02/Marker_300_square_02"
      smooth="true"
      smoothCount="5"
      smoothTolerance=".005"
      smoothThreshold="5"
    >
        <a-video src="#video_01" width="16" height="9" scale="70 70 70" position="350 0 0" rotation="-90 180 180" play-on-click></a-video>
    </a-nft>

    <a-entity camera></a-entity>
  </a-scene>
  <script>
    AFRAME.registerComponent('play-on-click', {
      init: function () {
        this.onClick = this.onClick.bind(this);
      },
      play: function () {
        window.addEventListener('click', this.onClick);
      },
      pause: function () {
        window.removeEventListener('click', this.onClick);
      },
      onClick: function (evt) {
        var videoEl = this.el.getAttribute('material').src;
        if (!videoEl) { return; }
        this.el.object3D.visible = true;
        videoEl.play();
      }
    });
  </script>
</body>

</html>